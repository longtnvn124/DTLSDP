<div #tooltip class="tooltip"></div>

<div #container class="container-vr ctn_body">

</div>

<p-contextMenu [target]="container" [model]="items" appendTo="body" *ngIf="!showOnly"></p-contextMenu>

<ng-template #fromUpdate>
  <div class="ovic-side-navigation-content h-100">
    <div class="ovic-side-navigation-content__head">
      <h4 class="ovic-side-navigation-content__head__title">{{formState ? formState.formTitle : ''}}</h4>
      <button (click)="closeForm()" pButton pRipple type="button" icon="pi pi-times"
              class="p-button-rounded p-button-danger p-button-text close ovic-side-navigation-content__head__btn-close"></button>
    </div>
    <div class="ovic-side-navigation-content__body ovic-scroll-style">
      <div class="ovic-vertical__inputs ovic-vertical__inputs--layout-2">
        <form [formGroup]="formSave" autocomplete="off">
          <div class="row">
            <div class="col-12">
              <p class="form-row">
                <label>Tên vị trí <span class="ovic-mark">*</span></label>
                <input type="text" placeholder="Tên vị trí..." formControlName="title"
                       autocomplete="off">
              </p>
            </div>

          </div>
          <div class="row">
            <div class="col-6">
              <p class="form-row">
                <label>loại điểm truy cập <span class="ovic-mark">*</span></label>
                <p-dropdown placeholder="Chọn..." class="w-100" [options]="typeOptions" optionLabel="label"
                            optionValue="value" formControlName='type'></p-dropdown>
              </p>
            </div>
            <div class="col-6">
              <p class="form-row">
                <label>Icon<span class="ovic-mark">*</span></label>
                <p-dropdown [options]="iconList" optionLabel="name" formControlName="icon" optionValue="path"
                            class="w-100" placeholder="chọn...">
                </p-dropdown>
              </p>

            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <p class="form-row">
                <label>Mô tả</label>
                <textarea formControlName="mota" placeholder="Mô tả..." autocomplete="off" cols="30"
                          rows="5"></textarea>
              </p>
            </div>
          </div>

          <div class="row" *ngIf="f['type'].value === 'DIRECT'">
            <div class="col-12">
              <div class="form-row">
                <label>Đích đến <span class="ovic-mark">*</span></label>
                <div class="w-100">
                  <button *ngIf="!destination; else showDestination" pRipple
                          class="btn-vr-chooser justify-content-center align-items-center" [class.btn-vr-chooser--invalid]="f['ds_ngulieu'].touched && formSave.getError('invalidPinable')" (click)="btnAddNgulieu('DIRECT')">
                    <span class="btn-vr-chooser__icon"></span>
                  </button>
                  <ng-template #showDestination>
                    <div class="list-vr-chooser" *ngIf="destination">
                      <div class="d-flex align-items-center w-100 mb-0">
                        <div class="btn-vr-chooser--single w-100 p-0 border-0">
                          <span class="btn-vr-chooser__icon" [class]="'btn-vr-chooser__icon--'+destination.loaingulieu"></span>
                          <p class="btn-vr-chooser__name">{{ destination.title }}</p>
                        </div>
                        <button class="btn-vr-chooser__control p-button-text p-button-rounded" pRipple pButton icon="pi pi-download"
                                (click)="dowloadNgulieu(destination)"></button>
                        <button class="btn-vr-chooser__control p-button-text p-button-danger p-button-rounded" pRipple pButton icon="pi pi-trash"
                                (click)="deleteNguLieuOnForm(destination)"></button>
                      </div>
                    </div>
                  </ng-template>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-12">
              <div class="form-row">
                <label>Danh mục ngữ liệu <span class="ovic-mark">*</span></label>
                <div class="list-vr-chooser">
                  <div class="d-flex align-items-center w-100" *ngFor="let n of otherInfo">
                    <div class="btn-vr-chooser--single pt-2 pb-2 px-0 border-0">
                      <span class="btn-vr-chooser__icon" [class]="'btn-vr-chooser__icon--'+n.loaingulieu"></span>
                      <p class="btn-vr-chooser__name">{{ n.title }}</p>
                    </div>
                    <button class="btn-vr-chooser__control p-button-text p-button-rounded" pRipple pButton icon="pi pi-download"
                            (click)="dowloadNgulieu(n)"></button>
                    <button class="btn-vr-chooser__control p-button-text p-button-danger p-button-rounded" pRipple pButton icon="pi pi-trash"
                            (click)="deleteNguLieuOnForm(n)"></button>
                  </div>
                  <div class="d-flex align-items-center w-100 border-0">
                    <button class="p-button-success w-100" pRipple pButton icon="pi pi-plus"
                            (click)="btnAddNgulieu('INFO')"></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="ovic-side-navigation-content__foot">
      <span class="ovic-side-navigation-content__foot__notice mr-auto"><mark>(*)</mark> bắt buộc phải nhập</span>
      <button pButton pRipple type="button" label="Cập nhật" icon="pi pi-save" (click)="saveForm()"
              class="p-button-success"></button>
      <button pButton pRipple type="button" label="Đóng" class="p-button-secondary ml-3" icon="pi pi-times"
              (click)="closeForm()"></button>
    </div>
  </div>
</ng-template>


<div class="onRight-bottom">
  <ng-template [ngIf]="viewRotate">
    <p-button class="m-2" [icon]="rotate ? 'pi pi-spin pi-spinner':'pi pi-refresh'" (onClick)="btnRotate()"></p-button>
  </ng-template>
  <ng-template [ngIf]="isAudio">
    <p-button class="m-2" icon="pi pi-volume-up" styleClass="p-button-secondary" (onClick)="btnVolume()"></p-button>
  </ng-template>
  <ng-template [ngIf]="typeNgulieu === 'video'">
    <p-button class="m-2" [icon]="video360.paused ? 'pi pi-play' : 'pi pi-pause'" styleClass="p-button-warning"
              (onClick)="btnPausePlay()"></p-button>
  </ng-template>
  <ng-template [ngIf]="destinationDiemditich && destinationDiemditich.loaingulieu === 'video360'">
    <p-button class="m-2" [icon]="video360.paused ? 'pi pi-play' : 'pi pi-pause'" styleClass="p-button-warning"
              (onClick)="btnPausePlay()"></p-button>
  </ng-template>
</div>

<!--<audio controls autoplay>-->
<!--  <source [src]="audioLink | ovicSafeUrl" type="audio/ogg">-->
<!--  <source [src]="audioLink | ovicSafeUrl" type="audio/mpeg">-->
<!--  Your browser does not support the audio element.-->
<!--</audio>-->

<p-dialog header="Thông tin chi tiết" [(visible)]="visible" [modal]="true" [style]="{ width: '60vw' }"
          [draggable]="false" [resizable]="false" class="m-0">
  <div class="w-100 d-flex">
    <div class="ctn-left d-block">
      <ng-container *ngIf="dataInformation">
        <div id="media" class="w-100 text-center">
          <img src="{{dataInformation['imageLink']}}" class="datainfo-body__img">
        </div>
        <!--        <div *ngIf="dataInformation.file_audio" id="audio" class="w-100 text-center">-->
        <!--          &lt;!&ndash;          <audio src="{{dataInformation['audioLink']}}"></audio>&ndash;&gt;-->
        <!--          <audio controls>-->
        <!--            <source src="{{dataInformation['audioLink']}}" type="audio/mpeg">-->
        <!--          </audio>-->
        <!--        </div>-->
      </ng-container>
    </div>
    <div class="ctn-right">
      <ng-container *ngIf="dataInformation">
        <div class="datainfo-title">
          <p class="datainfo-title__p m-auto">{{dataInformation.title}}</p>
        </div>
        <div class="datainfo-body mt-1">
          <div class="datainfo-body__dec">{{dataInformation.mota}}</div>
        </div>

      </ng-container>
    </div>
  </div>
</p-dialog>

<ng-template [ngIf]="backToScene">
  <button pButton pRipple type="button" label="Thoát" icon="pi pi-chevron-left" (click)="btnBackToScere($event)"
          class="btn-backtoScene p-button-secondary"></button>
</ng-template>

